
# 역사
<img src="https://github.com/JHPrk/HelloWorldie/assets/23393661/b12bae3c-f743-4604-88a1-f422626b7ffc" width="400">

- 1996년 자바 최초 Stable 버전인 1.0.2가 출시
  - 당시엔 JIT나 병렬/동시성 GC도 없었음
- 그러다가 1999년 JIT컴파일러가 등장
  - 메서드 인라인화 기능
  - 코드를 잘게 나누는게 더 중요해짐
  - GC도 성능이 빨리 향상됨
    - 멀티스레드 연산을 지원하는 가비지 컬렉터의등장
    - 거의 동시에 작동할 수 있게 됨

- JVM은 코드를 최적화

- JIT컴파일러는 네이티브 코드로 변환

자바 어플리케이션의 성능 문제를 해결하기 위해선 툴 사용법을 익혀야함

- JVM 라이브러리, 메모리, 컴파일러 GC, 하드웨어 지식까지
- 모든 성능 문제는 여러 개의 정답이 있음
    - 실현 가능한 해결책을 찾고 요건에 가장 알맞은 해결책을 조합하는 것이 핵심
- JVM을 모니터링하고 튜닝하자!!

# 자바의 진화

자바는 진화하고 있다. 따라서,
- 예전 조언들이 지금이랑 맞지 않는 경우가 많음
- JVM의 자동 인라이닝은 메서드 디스패치 성능을 엄청나게 좋아지게 함ㅅ
- 오래전 작성한 자바 코드도 재컴파일 없이 최신 JVM에서 구현하면 더 빨리 작동 가능
- 정량적, 검증 가능한 방식으로 성능을 다뤄야한다.

모든 최적화 기법에는 개발자가 사용하기 전에 알아야하는 함정과 트레이드오프가 존재한다.

# 자바의 성능에 대해서
자바는 원래부터 개발하기 편하라고 만든 언어라 개발자가 콜스택이 어떻게 되는지, JVM이 어떻게 동작하는지, 메모리 관리는 어떻게하는지 몰라도 개발할 수 있으면 좋겠다는 지극히 실용적인 언어이다.

그래서 개발 환경이 충분히 빠르다면 개발자 생산성이 높아지는 대가로 성능 희생을 감수하는 것이지만.. 

그러나 자바 어플리케이션의 성능을 측정하고 관리해야 하는 경우가 분명히 있음.

## 성능 측정의 함정
- JVM 어플리케이션의 성능 측정값은 정규 분포를 따르지 않는 경우가 많아 측정하기 힘들다.
  - 따라서 아웃라이어(이상치)도 중요하게 봐야한다.
- 측정값의 일부를 샘플링하는 것은 특이점을 일으킨 가장 중요한 이벤트가 묻혀버릴 수 있다.
- 측정 환경과 시스템을 개별적으로 따로 떼어내서 생각하는 것이 중요
- 측정하는 행위 자체도 오버헤드를 일으킬 수 있다 (양자역학..?)

## 성능에 대한 의견
이 책을 읽으며 공감했던 말은...
<center> <h3>소프트웨어 산업의 가장 경이적인 성과는 하드웨어 산업에서 꾸준이 이루어낸 혁신을 끊임없이 무용지물로 만들고 있는 것이다. </h3> - 헬리페트로스키</center>

이었고, 이는 결과적으로 하드웨어의 혁신이 일어날수록 소프트웨어 산업이 더더욱 복잡하고 높은 성능을 요구한다는 뜻이고, 이는 아무리 자바가 블루칼라 언어라곤 하지만, 개발자는 지속적으로 자바의 저수준 관리에 신경을쓰고 성능을 계속해서 관리해야한다는 말을 뜻한다고 생각했다.

자바는 범용 언어이기때문에 모든 상황, 환경에서 JVM의 최적화가 적합하지 않을수 있다는 점을 항상 인식하고 있어야한다.

## 성능측정의 기술
성능 튜닝은 기술, 방법론, 정량적 측정값, 툴을 망라한 개념이다.

성능은 다음과 같은 활동을 하면서 원하는 결과를 얻기위한 일종의 실험과학이다.
### 성능 측정법
1. 원하는 결과를 정의
2. 기존 시스템을 측정
3. 요건을 충족시키려면 무슨 일을 해야 할지 정의
4. 개선 활동을 추진
5. 다시 테스트
6. 목표가 달성되었는지 판단

즉, 현재 애플리케이션에 대한 성능 가설을 세우고, 여러 개선활동을 통해 검증하는데, 이를 여러 지표들을 통해 측정한다는 것임.

## 그렇다면 어떤 성능을 측정해야할까?
### 대표적인 성능 지표
1. 처리율
   - (서브)시스템이 수행 가능한 비율을 나타낸 지표
   - 일정 시간동안 완료한 작업 단위 수
   - 정확하게 측정하려면 하드웨어, OS등의 변수들을 인지하고 제어할 수 있어야함.
2. 지연
   - 종단 시간이라고도 하고, 작업을 수행하는데 걸리는 시간이라고 보면 된다.
3. 용량
   - 시스템이 보유한 작업 병렬성의 총량, 즉 동시 처리 가능한 작업단위(트랜잭션) 개수
   - 처리율과 밀접한 연관이 있음.
4. 사용률
   - 얼마나 시스템 리소스를 효율적으로 활용하는가?
   - 어떤 작업이냐에 따라 편차가 큼 (계산 집약적인가? 메모리 집약적인가?)
5. 효율
   - 처리율을 리소스 사용률로 나눈 값.
6. 확장성
   - 리소스 추가하면 처리율이 얼마나 증가하는가?
   - 리소스 추가에 따른 처리율 변화가 확장성의 척도
   - 선형적으로 확장되는 것이 제일 좋음
   - 그러나 여러 인자들의 영향을 받음.
7. 저하
   - 부하 증가에 따른 지연 증가를 저하라고 함.

이러한 성능 지표들을 서로 밀접한 연관이 있음.

### 이 모든 지표가 동시에 최적화 되는 경우는 거의 없음. 두세개정도 개선되는 경우가 많고 다른 지표는 성능이 악화될 수도 있음 (트레이드 오프 존재)

## 성능을 측정할 때 고려해야 할 점.
- JIT 컴파일 대상이 되는 메서드는 빈번하게 실행되어야 한다.
- 즉 실행 초기에는 대상이 아니어서 성능이 느리게 측정되다가 JIT 컴파일 대상이 되어 성능이 빨라질 수 있음.
   - 충분히 웜업을 수행한 이후에 측정 필요

- 지표들의 성능 그래프를 읽는 법을 알아야됨
  - 성능이 갑자기 저하되면 메모리 누수를 의심하거나 하는 등의 지식을 얻을 수 있다..!
   
## 결론
자바는 성능에 대해 무지해도 개발할 수 있는 언어이지만, 우리가 더 잘 개발하기 위해서는 JVM이 어떻게 동작하는지 알아야 한다. 더 좋은 개발자가 되기 위해서!




